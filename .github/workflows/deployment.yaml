name: site deployment
on:
    push:
        branches:
            - master
            - test
jobs:
    preparation:

        if: ${{ github.ref_name == 'test' }}
        runs-on: self-hosted
        steps:
            - name: print the github object
              env:
                WHATEVER: ${{ toJSON(github) }}
    
              run: echo $WHATEVER

            - name: checkout from the repository
              uses: actions/checkout@v4

            - name: build Docker image for this website and Run the image
              run: |
                BUILD_TAG=$(echo $RANDOM)
                sudo docker build -t simpleweb.com:$BUILD_TAG .
                sudo docker run -d -p 80:80 simpleweb.com:$BUILD_TAG



            


        

